{{define "admin_houses.tmpl"}}
    {{template "base" .}}
{{end}}

{{define "content"}}
    <section class="card">
        <h1 class="card-title">Admin panel — Manage houses</h1>

        <div class="form-row" style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
            <div style="font-weight:700;">Total: <span id="total-count">—</span></div>

            <label style="margin-left:auto;">
                Per page:
                <select id="limit-select">
                    <option value="10" selected>10</option>
                    <option value="20">20</option>
                    <option value="50">50</option>
                </select>
            </label>

            <button id="refresh-btn" class="btn" style="margin-left:8px;">Refresh</button>
        </div>

        <div class="form-row" style="margin-top:12px; gap:8px; align-items:center; flex-wrap:wrap;">
            <label style="flex:1;">
                Search (ID or address):
                <input id="pattern-input" type="text" placeholder="enter id or address" />
            </label>
            <button id="apply-filters" class="btn">Apply</button>
        </div>

        <div id="add-house-modal" class="card hidden" style="position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); z-index:200; width:90%; max-width:720px;">
            <h2 class="card-title">Add house</h2>
            <form id="add-house-form" class="form" data-endpoint="/api/staff/houses/create">
                <label>Address: <input name="address" type="text" required></label>
                <div class="form-row inline" style="margin-top:8px;">
                    <button id="add-house-save" type="submit" class="btn">Save</button>
                    <button id="add-house-cancel" type="button" class="btn">Cancel</button>
                </div>
                <output id="add-house-output" class="form-output" aria-live="polite"></output>
            </form>
        </div>

        <div id="update-house-modal" class="card hidden" style="position:fixed; left:50%; top:50%; transform:translate(-50%,-50%); z-index:200; width:90%; max-width:720px;">
            <h2 class="card-title">Update house</h2>
            <form id="update-house-form" class="form" data-endpoint="/api/staff/users/resident/update-house">
                <label>House ID: <input id="update-house-id" name="houseID" type="number" readonly></label>
                <label>Address: <input id="update-house-address" name="address" type="text" required></label>
                <div class="form-row inline" style="margin-top:8px;">
                    <button id="update-house-save" type="submit" class="btn">Save</button>
                    <button id="update-house-cancel" type="button" class="btn">Cancel</button>
                </div>
                <output id="update-house-output" class="form-output" aria-live="polite"></output>
            </form>
        </div>

        <div style="margin-top:12px;">
            <button id="add-house" class="btn">Add house</button>
        </div>

        <div id="houses-list" style="margin-top:16px;"></div>

        <div id="pagination" class="form-row center" style="margin-top:12px; gap:8px;">
            <button id="prev-page" class="btn">Prev</button>
            <div id="page-info" style="font-weight:700;">Page <span id="current-page">1</span> / <span id="total-pages">1</span></div>
            <button id="next-page" class="btn">Next</button>
        </div>

        <output id="houses-output" class="form-output" aria-live="polite"></output>
    </section>

    <script src="/static/js/admin_houses.js"></script>
{{end}}